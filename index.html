<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ett pussel f칬r dig</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #ffe6e6; /* Ljusrosa bakgrund */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            text-align: center;
            color: #d6336c;
        }

        h1 {
            margin-bottom: 20px;
            font-size: 1.5rem;
        }

        /* Pussel-containern */
        #puzzle-container {
            width: 300px;
            height: 300px;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 1fr);
            gap: 2px;
            background-color: #d6336c;
            border: 5px solid #d6336c;
            border-radius: 10px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }

        .tile {
            width: 100%;
            height: 100%;
            background-image: url('valentine.jpg'); /* H칛r laddas din bild */
            background-size: 300px 300px; /* M친ste matcha containerns storlek */
            cursor: pointer;
            transition: transform 0.2s ease;
        }

        /* Markera vald ruta */
        .tile.selected {
            border: 2px solid #fff;
            box-shadow: 0 0 10px #d6336c;
            z-index: 10;
        }

        /* Sektionen som visas n칛r man vinner */
        #valentine-proposal {
            display: none; /* Dold fr친n b칬rjan */
            margin-top: 30px;
            animation: fadeIn 2s;
        }

        .message {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .question {
            font-size: 1.2rem;
            margin-bottom: 20px;
            color: #333;
        }

        .buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
        }

        button {
            padding: 10px 30px;
            font-size: 1.2rem;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: transform 0.1s;
        }

        #yes-btn {
            background-color: #d6336c;
            color: white;
        }

        #yes-btn:hover {
            background-color: #a61e4d;
            transform: scale(1.1);
        }

        #no-btn {
            background-color: #ccc;
            color: #555;
        }

        /* Resultattext efter JA */
        #final-yay {
            display: none;
            margin-top: 20px;
            font-size: 2rem;
            color: #d6336c;
            animation: bounce 1s infinite;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
    </style>
</head>
<body>

    <h1 id="instruction">Kan du l칬sa pusslet?</h1>

    <div id="puzzle-container">
        <!-- Pusselbitar genereras av JavaScript -->
    </div>

    <div id="valentine-proposal">
        <div class="message">You complete me 仇벒잺</div>
        <div class="question">Vill du vara min valentine?</div>
        <div class="buttons">
            <button id="yes-btn">Ja</button>
            <button id="no-btn">Nej</button>
        </div>
        <div id="final-yay">Yay, jag l칛ngtar! 游봃</div>
    </div>

    <script>
        // Konfiguration
        const size = 3; // 3x3 grid
        const container = document.getElementById('puzzle-container');
        let tiles = []; // H친ller koll p친 nuvarande ordning
        let selectedTileIndex = null; // H친ller koll p친 vilken ruta som 칛r klickad
        
        // Den l칬sta ordningen (0-8)
        const solvedState = [0, 1, 2, 3, 4, 5, 6, 7, 8];

        // Initiera spelet
        function initGame() {
            // Skapa array med nummer 0-8
            tiles = [...solvedState];
            
            // Blanda pusslet
            // VIKTIGT: Vi blandar genom att simulera giltiga drag bakl칛nges.
            // Om man bara slumpar arrayen kan pusslet bli om칬jligt att l칬sa.
            shuffleTiles();
            
            renderGrid();
        }

        function shuffleTiles() {
            // Enkel slumpm칛ssig blandning f칬r alla rutor
            for (let i = tiles.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [tiles[i], tiles[j]] = [tiles[j], tiles[i]];
            }
        }

        function renderGrid() {
            container.innerHTML = '';
            tiles.forEach((tileIndex, positionIndex) => {
                const div = document.createElement('div');
                div.classList.add('tile');
                
                // R칛kna ut vilken del av bilden som ska visas
                // tileIndex 칛r vilken bit det 츿R (0-8)
                const row = Math.floor(tileIndex / size);
                const col = tileIndex % size;
                
                // S칛tt bakgrundsposition (negativa v칛rden f칬r att flytta bilden)
                div.style.backgroundPosition = `-${col * 100}px -${row * 100}px`;

                // Markera om den 칛r vald
                if (positionIndex === selectedTileIndex) {
                    div.classList.add('selected');
                }

                div.onclick = () => handleTileClick(positionIndex);

                container.appendChild(div);
            });
        }

        function handleTileClick(index) {
            if (selectedTileIndex === null) {
                // Ingen ruta vald 칛n, v칛lj denna
                selectedTileIndex = index;
                renderGrid();
            } else if (selectedTileIndex === index) {
                // Klickade p친 samma ruta igen, avmarkera
                selectedTileIndex = null;
                renderGrid();
            } else {
                // Tv친 olika rutor valda, byt plats p친 dem
                [tiles[selectedTileIndex], tiles[index]] = [tiles[index], tiles[selectedTileIndex]];
                selectedTileIndex = null; // 칀terst칛ll val
                renderGrid();
                checkWin();
            }
        }

        function checkWin() {
            // Kolla om arrayen matchar [0, 1, 2, ... 8]
            const isSolved = tiles.every((val, index) => val === index);

            if (isSolved) {
                handleWin();
            }
        }

        function handleWin() {
            // 1. Ta bort klick-event (frys spelet)
            const allTiles = document.querySelectorAll('.tile');
            allTiles.forEach(t => t.onclick = null);

            // 3. 츿ndra rubrik och visa f칬rslaget
            document.getElementById('instruction').innerText = "Grattis!";
            document.getElementById('valentine-proposal').style.display = 'block';
            
            // Scrolla ner lite mjukt s친 man ser fr친gan
            setTimeout(() => {
                document.getElementById('valentine-proposal').scrollIntoView({behavior: "smooth"});
            }, 500);
        }

        // Knapp-logik
        document.getElementById('yes-btn').addEventListener('click', () => {
            document.getElementById('final-yay').style.display = 'block';
            // G칬m knapparna s친 man inte kan klicka igen
            document.querySelector('.buttons').style.display = 'none';
            
            // Starta konfetti (valfritt, men kul effekt)
            confettiEffect();
        });

        document.getElementById('no-btn').addEventListener('click', () => {
            // G칬r ingenting, precis som best칛llt.
            console.log("Hon klickade nej, men vi ignorerar det.");
        });

        // En enkel konfetti-effekt f칬r "Ja"-klicket
        function confettiEffect() {
            const colors = ['#ff0000', '#ff69b4', '#ffffff'];
            for(let i=0; i<100; i++) {
                const conf = document.createElement('div');
                conf.style.position = 'fixed';
                conf.style.left = Math.random() * 100 + 'vw';
                conf.style.top = '-10px';
                conf.style.width = '10px';
                conf.style.height = '10px';
                conf.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                conf.style.transition = 'top 3s ease-in, transform 3s ease-in';
                conf.style.zIndex = '9999';
                document.body.appendChild(conf);

                setTimeout(() => {
                    conf.style.top = '110vh';
                    conf.style.transform = `rotate(${Math.random() * 360}deg)`;
                }, 100);
            }
        }

        // Starta spelet n칛r sidan laddas
        initGame();

    </script>
</body>
</html>
